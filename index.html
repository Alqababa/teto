<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>نموذج تسجيل الفواتير</title>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
        background: #f8f9fa;
      }
      form {
        background: white;
        padding: 20px;
        border-radius: 8px;
        max-width: 500px;
        margin: auto;
        box-shadow: 0 0 10px #ccc;
      }
      input,
      textarea,
      button {
        width: 100%;
        margin: 10px 0;
        padding: 10px;
      }
      button {
        background: green;
        color: white;
        border: none;
        border-radius: 4px;
      }
      .msg {
        text-align: center;
        color: green;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h2 style="text-align: center">تسجيل الفاتورة</h2>

    <form id="invoiceForm">
      <input id="invoiceNumber" placeholder="رقم الفاتورة" required />
      <input id="invoiceDate" type="date" required />
      <input id="supplier" placeholder="اسم المورد" required />
      <input
        id="totalAmount"
        type="number"
        placeholder="إجمالي المبلغ"
        required
      />
      <textarea
        id="items"
        placeholder="تفاصيل الأصناف (مثال: منتج - كمية - سعر)"
        required
      ></textarea>
      <button type="submit">حفظ الفاتورة</button>
      <div class="msg" id="message"></div>
    </form>

    <script>
      // إعداد Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyDDy_qWmMa1qWyz2C50h0SFd25ZN6Re6N0",
        authDomain: "invoices-a26f7.firebaseapp.com",
        projectId: "invoices-a26f7",
        storageBucket: "invoices-a26f7.firebasestorage.app",
        messagingSenderId: "104648548938",
        appId: "1:104648548938:web:7631ae5941fc3c20ab3cb3",
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      document
        .getElementById("invoiceForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const data = {
            invoiceNumber: document.getElementById("invoiceNumber").value,
            invoiceDate: document.getElementById("invoiceDate").value,
            supplier: document.getElementById("supplier").value,
            totalAmount: parseFloat(
              document.getElementById("totalAmount").value
            ),
            items: document.getElementById("items").value,
            createdAt: new Date().toISOString(),
          };

          try {
            await db.collection("invoices").add(data);
            document.getElementById("message").textContent =
              "✅ تم حفظ الفاتورة";
            document.getElementById("invoiceForm").reset();
          } catch (err) {
            document.getElementById("message").textContent = "❌ حدث خطأ";
            console.error(err);
          }
        });
    </script>
  </body>
</html>
